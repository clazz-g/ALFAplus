---
title: "Parity and AD specific neurodegeneration"
author: "Clazz"
toc: true
number-sections: true
format: 
  html:
    code-fold: true
  docx: default 
editor: visual
bibliography: references.bib
csl: elsevier-vancouver.csl
---

```{r, include = F}
library(readxl)
#install.packages("ggplot2")
library(ggplot2)
#install.packages("psych")
library(psych)
#install.packages("tidyverse")
library(tidyverse)
#install.packages("ggpubr")
library(ggpubr)
#install.packages("broom")
library(broom)
#install.packages("ggeffects")
library(ggeffects)
#install.packages("MASS")
library(MASS)
#install.packages("mice")
library(mice)
#install.packages("VIM")
library(VIM)
#install.packages("car")
library(car)
#install.packages("sjPlot")
library(sjPlot)
#install.packages("caret")
library(caret)
#install.packages("bestNormalize")
library(bestNormalize)
#install.packages("ggrain")
library(ggrain)
#install.packages("emmeans")
library(emmeans)
#install.packages("skimr")
library(skimr)
library(glmnet)
#install.packages("bullseye")
library(bullseye)
#install.packages("lavaan")
library(lavaan)
#install.packages("brms")
library(brms)
#install.packages("mgcv")
library(mgcv)
library(splines)
#install.packages("fitdistrplus")
library(fitdistrplus)
#install.packages("patchwork")
library(patchwork)
#install.packages("lme4")
library(lme4)
#install.packages("lmerTest")
library(lmerTest)
library(gtsummary)
library(broom.mixed)
library(purrr)
library(huxtable)
library(pwrss)
```

```{r setup, include=FALSE}
# Register an inline hook:
options(scipen = 1, digits = 3)

```

```{r, include=FALSE}
## Plot aesthetics


call_aesthethics <- function(text_size){
  th <- theme(   panel.grid.major = element_blank(),
                 panel.grid.minor = element_blank(),
                 panel.border = element_blank(),
                 panel.background = element_blank(),
                 axis.line = element_line(linewidth = 0.5),
                 legend.position = 'right',
                 legend.text = element_text(size= text_size, family="Helvetica"),
                 text = element_text(size= text_size, family="Helvetica"),
                 strip.text.x = element_text(size = rel(0.90)),
                 strip.text.y = element_text(size = rel(0.90)),
                 axis.title.x = element_text(vjust=-0.3),
                 plot.title = element_text(hjust = 0.5, vjust = 0),
                 axis.ticks = element_line(linewidth = 0.4),
                 axis.text.x.bottom  = element_text(size = rel(0.90), margin = unit(c(t = 2.5, r = 0, b = 0, l = 0), "mm")),
                 axis.title.y = element_text(vjust = 1),
                 axis.text.y = element_text(size = rel(0.90), margin = unit(c(t = 0, r = 2.5, b = 0, l = 0), "mm")),
                 axis.ticks.length = unit(-1.2, "mm"),
                 axis.text.x.top = element_text(size = rel(0.90), margin = unit(c(t = 0, r = 0, b = 2.5, l = 0), "mm")))
  return(th)
}


th <- call_aesthethics(15)

```

```{r}
# Lancet Guidelines
# Be up to 3500 words (4500 for randomised controlled trials) with 30 references (the word count is for the manuscript text only) • Include an abstract (semi-structured summary), with five paragraphs (Background, Methods, Findings, Interpretation, and Funding), not exceeding 300 words. Our electronic submission system will ask you to copy and paste this section at the “Submit Abstract” stage • For randomised trials, the abstract should adhere to CONSORT extensions: abstracts (see Lancet 2008; 371: 281–83) • When reporting Kaplan-Meier survival data, at each timepoint, authors must include numbers at risk, and are encouraged to include the number of censored patients. • For intervention studies, the abstract should include the primary outcome expressed as the difference between groups with a confidence interval on that difference (absolute differences are more useful than relative ones). Secondary outcomes can be included as long as they are clearly marked as secondary and all such outcomes are reported • Use the recommended international non-proprietary name (rINN) for drug names. Ensure that the dose, route, and frequency of administration of any drug you mention are correct • All accepted Articles should include a link to the full study protocol published on the authors’ institutional website (see Lancet 2009; 373: 992 and Lancet 2010; 375: 348) • We encourage researchers to enrol women and ethnic groups into clinical trials of all phases, and to plan to analyse data by sex and by race
# 
# All research papers (including systematic reviews/meta-analyses) submitted to any journal in The Lancet family must include a panel putting their research into context with previous work in the format outlined below (see Lancet 2014; 384: 2176–77, for the original rationale). This panel should not contain references. Editors will use this information at the first assessment stage and peer reviewers will be specifically asked to check the content and accuracy • The Discussion section should contain a full description and discussion of the context. Authors are also invited to either report their own, up-to-date systematic review or cite a recent systematic review of other trials, putting their trial into context of the review
```

# Abstract

300 words

# Introduction

# Methods

## Study design

This study was realised within the context of the The ALFA+ project, a longitudinal observational cohort of healthly middle aged adults. This project currently takes place in the city of Barcelona, Spain, at the BarcelonaBeta Brain Research Center. Visit 1 was collected between ... and ..., and Visit 2 between ... and ... Visit 3 is still undergoing. The ALFA study protocol was approved by the Independent Ethics Committee Parc de Salut Mar Barcelona (and registered at Clinicaltrials.gov, NCT01835717). For a more detailed description of the cohort see Molinuevo et al.[@molinuevo2016].

## Participants

```{r, include=FALSE}
# creating basic dataset

data<-read_delim("G:/My Drive/Data/ALFA+/ALFA_dataset_basic.csv", 
    delim = ",", escape_double = FALSE, trim_ws = TRUE)%>%
  mutate(sex=factor(sex),
         APOE_binary = factor(APOE_binary))


#adding scan dates for descriptives, horizontal 
date_mri_v1<-read_excel("G:/My Drive/Data/ALFA+/neuroimaging/bx_scandates_ALFA_PLUS_V1_20231120_20250210_135308.xlsx")%>%
  dplyr::select(subject_label, scandate)%>%
  mutate(subject_label = as.numeric(subject_label))%>%
  rename(subject = subject_label,
         scandate_v1 = scandate)

date_mri_v2<-read_excel("G:/My Drive/Data/ALFA+/neuroimaging/bx_scandates_ALFA_PLUS_V2_20230518_20250210_135351.xlsx")%>%
  dplyr::select(subject_label, scandate)%>%
  mutate(subject_label = as.numeric(subject_label))%>%
  rename(subject = subject_label,
         scandate_v2 = scandate)

date_mri_long<-full_join(date_mri_v1, date_mri_v2)%>%
  mutate(scandate_v1 = as.Date(scandate_v1, format = "%Y-%m-%d"),
         scandate_v2 = as.Date(scandate_v2, format = "%Y-%m-%d"),
         diff_mri = as.numeric(difftime(scandate_v2, scandate_v1, units = c("days")))/365.25)

#adding MRI sessions dates to the dataset
data<-left_join(data, date_mri_long)%>%
  mutate(DOB = as.Date (DOB, format = "%Y-%m-%d"),
         age_v1_mri = as.numeric(difftime(scandate_v1, DOB, units= c("days")))/365.25,
         age_v2_mri = as.numeric(difftime(scandate_v2, DOB, units= c("days")))/365.25)

data_biomarkers<-read_delim("G:/My Drive/Data/ALFA+/biomarkers/biomarkers_CSF_processed.csv", 
    delim = ",", escape_double = FALSE, trim_ws = TRUE)%>%
  filter(Visit == "V1")%>%
  dplyr::select(-Visit)

data<-left_join(data, data_biomarkers)%>%
  mutate(A = factor(A))

participants_v1_cog<-read_excel("G:/My Drive/Data/ALFA+/Cognition/PACCv1_to_v3(incomplete).xlsx")%>%
  dplyr::select(IdParticipante, Visit, Z_PACC)%>%
  rename(subject = IdParticipante)%>%
  mutate(subject = as.numeric(subject))%>%
  filter(Visit == 1)%>%
  dplyr::select(subject)%>%
  nrow()


participants_v2_cog<-read_excel("G:/My Drive/Data/ALFA+/Cognition/PACCv1_to_v3(incomplete).xlsx")%>%
  dplyr::select(IdParticipante, Visit, Z_PACC)%>%
  rename(subject = IdParticipante)%>%
  mutate(subject = as.numeric(subject))%>%
  filter(Visit == 2)%>%
  dplyr::select(subject)%>%
  nrow()
  

participants_v1_mri<-data%>%
  drop_na(scandate_v1)%>%
  nrow

participants_v2_mri<-data%>%
  drop_na(scandate_v2)%>%
  nrow

participants_v1_bio<-read_delim("G:/My Drive/Data/ALFA+/biomarkers/biomarkers_CSF_processed.csv", 
    delim = ",", escape_double = FALSE, trim_ws = TRUE)%>%
  filter(Visit == "V1")%>%
  nrow()

participants_v2_bio<-read_delim("G:/My Drive/Data/ALFA+/biomarkers/biomarkers_CSF_processed.csv", 
    delim = ",", escape_double = FALSE, trim_ws = TRUE)%>%
  filter(Visit == "V2")%>%
  nrow()
```

In brief, inclusion criteria were being cognitively normal, Spanish and/or Catalan-speaking, being aged between 45 and 74 years and agreing with the study procedures and tests. A close relative was involved in the volunteer’s functional evaluation and both of them had to grant their written informed consent. Exclusion criterias Exclusion criteria were (1) Cognitive performance falling outside the established cutoffs, (2) a Clinical Dementia Rating above 0, (3) major psychiatric disorders (according to DSM-IV-TR), (4) Severe auditory and/or visual disorder, neurodevelopmental and/or psychomotor disorder, (5) Signiﬁcant diseases that could currently interfere with cognition, (6) neurological disorders, (7) Brain injuries and (8) a suspected pattern of family autosomal dominant AD.

In addition to the above exclusion criteria, women with history of cardiovascular related gestational disease, such as preeclampsia, were excluded from our sample for analysis.

Participants were recruited via advertisement campaigns in newspapers and followed-up via email/phonecalls.

## Procedures

### Demographics

Demographic data was collected via oral questions administered by a clinician. Sex was self reported, and participants could choose from three options: male, female, or ... Race and ethnicity were also self-reported.

Reproductive variables, such as number of biological kids, age at menopause, age at menarche and number of abortions, were self-reported at the baseline visit. In the subsequent visits, participants were also asked about hormonal replacement therapy.

Social variables such as years of education, household income, occupational attainment and civil status were also self-reported at baseline visit.

### MRI acquisition

MRI scans were acquired on a in-house 3.0 T scanner (GE Discovery MR750 W 3 T) using the same protocol for all participants, which included one T1- and three T2- weighted sequences. The 3D-T1w sequence was designed with an isotropic voxel size of1mm3 and a matrix size of256x256x160 (TR/TE/TI = 8.0/3.7/450 ms, NSA = 1, flip angle = 8°). Three 3D-T2w sequences, with a voxel size of1 mm× 1 mm× 3 mm, were also used: fluid attenuation inversion recovery (FLAIR: TR/TE/ TI = 11,000/90/2600 ms, flip angle = 160°), fast spin echo (FSE: TR/TE = 5000/85 ms, flip angle = 110°) and, gradient echo (GRE: TR/TE = 1300/23 ms, flip angle = 15°). All scans were visually assessed to verify their quality and to detect incidental findings by a trained neuroradiologist and have been reported elsewhere (Brugulat-Serrat et al. 2017). At visit 1, ten participants were excluded due to the presence of a meningioma, as well as 37 participants due to susceptibility, motion artefacts or segmentation problems, resulting in a total of 561 images available for subsequent analysis. At Visit 2, ... The medial temporal lobe atrophy was assessed by Medial Temporal Atrophy scale [@scheltens1992a].

### Hippocampal segmentation

Hippocampal subfield volumes were automatically calculated by FreeSurfer 7 using whole hippocampal segmentation provided by the standard ‘recon-all’ pipeline, which renders the most standard and widely-used volumetric estimation of hippocampal volumes. The subfields were delimited as following: CA1, CA3, CA4, GC-ML-DG, molecular layer, fimbria, parasubiculum, subiculum, presubiculum, HATA, fissure, and tail. However, the fissure was removed from the analysis because of its lack of particular relevance to our topic.

Repoduction of the analysis using ASHS segmentation can be found in the Appendix section.

![Freesurfer 7 segmentation pipeline.](ad_signatures_files/hipp%20subfield%20segmentation.png)

### Lumbar puncture

CSF was collected by lumbar puncture between 9 and 12 a.m. in polypropylene tubes. Samples were processed within 1 hour and centrifuged at 4°C for 10 minutes at 2000 g, stored in polypropylene tubes and frozen at -80°C. Core AD biomarkers (namely Ab42, Ab40, total Tau, and p tau) and other molecules of interest (such as YKL-40, neurogranin and Ab oligomers) were analyzed and determined in Prof. Kaj Blennow’s laboratory (Institute ofNeuroscience and Physiology, Department of Psychiatry and Neurochemistry, The Sahlgrenska Academy at the University of Gothenburg, Sweden).

### Cognitive measures

The Preclinical Alzheimer Cognitive Composite (PACC) was developed to detect subtle cognitive changes in individuals who may be in the pre-clinical stages of AD [@Donohue2014], and includes elements of the Memory Binding Test, the Coding subtest of WAIS-IV, and semantic fluency. Z-scores were computed for Visit 1 and 2.

## Statistical analyses

This analysis is opportunistic, in the sense that the ALFA+ cohort was designed to provide data for a wide range of questions. Consequently, this study sample size limits the kind of analysis we are able to perform. Because of this, we chose not to include results from stratified analysis in this paper because of a high chance of yielding type II errors.

### Linear regression models

Statistical analyses were carried using R v4.5.1. Our exposure variables included parity, time and Aβ positivity. Parity was defined as number of biological children and treated as a continuous predictor. Time was assessed as number of days between either MRI scans or cognitive testing sessions at visit 1 and 2. Aβ positivity was defined using a CSF Aβ42/40 ratio inferior to 0.071. All analyses were stratified by sex.

To identify other potential confounders in our primary analyses, we used directed acyclic graph (DAG) methodology to aid with covariate selection. Using Pearl's backdoor criteria, we decided to covary for education in all our analyses given that the effet of this variable on both the exposure and outcome variable, therefore making it a cofounding variable in our analyses along with age at baseline. All linear regressions were also adjusted for age at baseline, APOE-4 status, time and Aβ status when not part of the interaction. Linear regressions with hippocampal subfield volumes as outcomes were adjusted for Total Intracranial Volume (TIV). p-values were adjusted using the False Discovery Rate (FDR) method.

```{r, include=F}
library(dagitty)
library(ggdag)

set.seed(123)

g <- dagitty("dag{  
  APOE_binary -> {A vol_Whole_hippocampus}
  age_v1 -> {kids_total CAIDE_scr_20M1 Hormones HRT_pmm vol_Whole_hippocampus A}
  kids_total -> {CAIDE_scr_20M1 Hormones}
  Hormones -> {repro_span CAIDE_scr_20M1 vol_Whole_hippocampus};
  education -> {kids_total CAIDE_scr_20M1 ingreso_hogar vol_Whole_hippocampus A};
  repro_span -> {HRT_pmm CAIDE_scr_20M1 vol_Whole_hippocampus};
  HRT_pmm -> CAIDE_scr_20M1 ;
  ingreso_hogar -> {CAIDE_scr_20M1};
  CAIDE_scr_20M1 -> {A vol_Whole_hippocampus};
  A -> vol_Whole_hippocampus
  kids_total [exposure]
  vol_Whole_hippocampus [outcome]
  Hormones [unobserved]
 }")

coords<-list(
  x=c(age_v1 = 1, APOE_binary = 1, kids_total = 3, education = 2, HRT_pmm = 3, repro_span = 3, ingreso_hogar = 3, CAIDE_scr_20M1 = 4, A= 5, vol_Whole_hippocampus = 6),
  y=c(age_v1 = 0, APOE_binary = 2, education = 1, HRT_pmm= 0, kids_total = -1, repro_span = 1, ingreso_hogar= 2, CAIDE_scr_20M1= 1, A = 1, vol_Whole_hippocampus = 1))

dag_r<-dagify(vol_Whole_hippocampus ~ kids_total + education + age_v1 + CAIDE_scr_20M1+ A + HRT_pmm + age_v1,
              CAIDE_scr_20M1 ~ repro_span + HRT_pmm + kids_total + age_v1 + education + ingreso_hogar,
              ingreso_hogar ~ education,
              A ~ age_v1 + APOE_binary + CAIDE_scr_20M1,
              kids_total ~ education + age_v1,
              labels = c(kids_total = "Parity",
                         APOE_binary = "APOE-E4 Carriership",
                         education = "Education",
                         repro_span = "Reproductive span",
                         CAIDE_scr_20M1 = "CAIDE score",
                         A = "Aβ status",
                         HRT_pmm = "HRT",
                         vol_Whole_hippocampus = "Whole hippocampal volume",
                         age_v1 = "Age at baseline",
                         ingreso_hogar = "Household income"),
              exposure = "kids_total",
              outcome = "vol_Whole_hippocampus",
              coords = coords)

dag_r_tidy<-tidy_dagitty(dag_r, layout="nicely")%>%
  node_dconnected(controlling_for = c("age_v1", "education"))
```

```{r, echo=F, warning=F}
dag_r_tidy%>%
  mutate(adjusted=str_to_title(adjusted),
         arrow=ifelse(adjusted == "Adjusted", 0.15, 0.85))%>%
  ggplot(aes(x=x, y=y, xend=xend, yend=yend, colour=adjusted, fill=adjusted, shape=adjusted))+
  geom_dag_point()+
  geom_dag_edges(aes(edge_alpha=arrow), edge_width=0.7)+
  geom_dag_label_repel(aes(label = label), colour = "white", show.legend = FALSE)+
  theme_dag() +
  theme(legend.position= "none")+
  scale_shape_manual(values = c(22, 21))
```

We first carried out linear mixed-effect models including parity and time as exposure and hippocampal volume as outcome. AD-specific biomakrers were then introduced as a moderator. These analyses were reproduced using PACC as outcome. For sensitivity analyses, we performed the same linear regressions but stratified by Aβ positivity. We also tested the inclusion of other covariates to examine the effect of AD-related biomarkers, female reproductive health and social factors on our outcomes. Mediation analyses were performed...

Data imputation methods were implemented using the mice package in R (v.3.18.0) on covariates, but not exposure or outcome variables. For continous variables, predictive mean matching with 5 donors was used. For categorical variables, logistic regression was used.

# Results

## Descriptive results

```{r, include = F}
data_table<-data%>%
  mutate(TIV_cm=TIV/100)%>%
  dplyr::select(age_v1, kids_total, A, APOE_binary, diff_mri, education)%>%
  mutate(A=ifelse(A==1, "Aβ+", "Aβ-"),
         APOE_binary=ifelse(APOE_binary==1, "Carrier", "Non-Carrier"))
 

desc_table<-tbl_summary(data_table,
            by = kids_total, 
            missing = "no",
            label= list(kids_total = "Number of childbirths",
                     A= "Aβ status, Count (%)",
                     APOE_binary = "APOE-E4 carrier, Count (%)",
                     age_v1 = "Age at first visit, Mean (SD)",
                     TIV_cm = "Total Intracranial Volume (cm3), Mean (SD)",
                     diff_mri = "Time between visits (years), Mean (SD)",
                     education = "Education (years), Mean (SD)"))%>%
  add_n()%>%
  add_p%>%
  modify_header(label = "**Number of childbirths**") %>% # update the column header
  bold_labels()


```

```{r, echo = F, warning=F}
desc_table
```

`r nrow(data)` participants from the ALFA+ project were included in our analyses, of which `r nrow(data[data$sex==2,])` are women. Visit 1 included MRI data from `r participants_v1_mri` participants, cognitive testing from `r participants_v1_cog` participants and CSF biomarkers from `r participants_v1_bio` participants. Visit 2 included MRI data from `r participants_v2_mri` participants, cognitive testing from `r participants_v2_cog` participants and CSF biomarkers from `r participants_v2_bio` participants. Average time between visits was 3.32 years.

(Flowchart?)

Table 1 shows demographics and characteristics of the ALFA+ cohort for all aprticipants included in Visit 1, grouped by parity. Participants with higher parity were significantly more likely to be older. No difference was seen between groups regarding Aβ status and APOE-ε4 carriership.

## Whole Hippocampal volume

```{r, include = F}
ashs1<-read_excel("G:/My Drive/Data/ALFA+/neuroimaging/ASHS/bx_ashs_volumes_ALFA_PLUS_V1_20231120_20250702_164509.xlsx")%>%
  dplyr::select(subject, region, side, volume)%>%
  group_by(subject, region) %>%
  summarize(volume = sum(volume), .groups = "drop")%>%
  pivot_wider(names_from = region, values_from = volume, names_prefix = "vol_")%>%
  mutate(Visit = 1)

ashs1b<-read_excel("G:/My Drive/Data/ALFA+/neuroimaging/ASHS/bx_ashs_volumes_ALFA_PLUS_EXP_20250918_161906.xlsx")%>%
  dplyr::select(subject, region, side, volume)%>%
  group_by(subject, region) %>%
  summarize(volume = sum(volume), .groups = "drop")%>%
  pivot_wider(names_from = region, values_from = volume, names_prefix = "vol_")%>%
  mutate(Visit = 1)%>%
  filter(subject != "11331",
         subject != "10634")
  

ashs2<-read_excel("G:/My Drive/Data/ALFA+/neuroimaging/ASHS/bx_ashs_volumes_ALFA_PLUS_V2_20230518_20250702_165801.xlsx")%>%
  dplyr::select(subject, region, side, volume)%>%
  group_by(subject, region) %>%
  summarize(volume = sum(volume), .groups = "drop")%>%
  pivot_wider(names_from = region, values_from = volume, names_prefix = "vol_")%>%
  mutate(Visit = 2)

data_ashs<-ashs1%>%
  bind_rows(ashs1b)%>%
  bind_rows(ashs2)%>%
  mutate(subject = as.numeric(subject),
         vol_HIPP = vol_CA1+vol_CA2+vol_CA3+vol_DG+vol_SUB)%>%
  right_join(., data)%>%
  mutate(diff_mri = ifelse(Visit==1, 0, diff_mri))#%>%
  #filter(subject != 21136,
         #subject != 12560,
         #subject !=12489)
```

```{r, include = F}
mod_ashs_simple<-lmer(vol_HIPP ~  kids_total*diff_mri+A +age_v1 +APOE_binary + scale(vol_tiv) + education  +(1|subject), data = data_ashs[data_ashs$sex==2,])
summary(mod_ashs_simple)

mod_ashs<-lmer(vol_HIPP ~  kids_total*A*diff_mri +age_v1 +APOE_binary + scale(vol_tiv) + education  +(1|subject), data = data_ashs[data_ashs$sex==2,])
summary(mod_ashs)
plot_model(mod_ashs, type="int")

```

We found no significant independent effect of parity on whole hippocampal volume. However, a significant parity and Aβ positivity interaction was found (β = `r tidy(mod_ashs)$estimate[9]`, p = `r tidy(mod_ashs)$p.value[9]`), such that Aβ- women showed a positive relationship between parity and hippocampal volume, whilst Aβ- women showed the opposite (Figure X). No significant interaction with time was found, indicating that this effect appears constant over visits.

```{r, echo=F, warning=F}

mod_ashs_plot<- lme4::lmer(vol_HIPP ~  kids_total*diff_mri*A +age_v1 +APOE_binary + scale(vol_tiv) + education  +(1|subject), data = data_ashs[data_ashs$sex==2,])
preds_hip_int <- ggpredict(mod_ashs_plot, terms = c("diff_mri", "kids_total", "A"))

preds_hip_int_A0<-as.data.frame(preds_hip_int)%>%
  rename(kids_total_factor = group,
         A=facet)%>%
  filter(A==0)%>%
  mutate(A = ifelse(A==0, "Aβ-", "Aβ-"),
         kids_total_factor = ifelse(kids_total_factor == 4, "4+", as.character(kids_total_factor)))


preds_hip_int_A1<-as.data.frame(preds_hip_int)%>%
  rename(kids_total_factor = group,
         A=facet)%>%
  filter(A==1)%>%
  mutate(A = ifelse(A==1, "Aβ+", "Aβ+"),
         kids_total_factor = ifelse(kids_total_factor == 4, "4+", as.character(kids_total_factor)))


data_ashs %>%
  filter(sex == 2, !is.na(A)) %>%
  mutate(kids_total_factor = ifelse(kids_total == 4, "4+", as.character(kids_total)),
         A = factor(A, levels = c("0", "1"), labels = c("Aβ-", "Aβ+"))) %>%
  ggplot(aes(x = diff_mri, y = vol_HIPP, color = kids_total_factor)) +
  geom_point(alpha = 0.6, size=2) +
  geom_line(data =preds_hip_int_A0, aes(x=x, 
                                y=predicted, 
                                group=kids_total_factor), size=1.3) +
  geom_line(data =preds_hip_int_A1, aes(x=x, 
                                y=predicted, 
                                group=kids_total_factor), size=1.3) +
  geom_ribbon(data =preds_hip_int_A0, aes(x=x,  
                                  ymin= conf.low, 
                                  ymax = conf.high, 
                                  group=kids_total_factor), inherit.aes = F, alpha=.07)+
  geom_ribbon(data =preds_hip_int_A1, aes(x=x,  
                                  ymin= conf.low, 
                                  ymax = conf.high, 
                                  group=kids_total_factor), inherit.aes = F, alpha=.07)+
  facet_wrap(~A) +
  scale_color_manual(values = c("0" = "#8AD9B5", "1" = "#50B88E", "2" = "#047A56", "3" = "#0A5940", "4+" = "#0F3F2D")) +
  th +
  labs(x = "Time difference (years)", 
       y = "Whole hippocampus", 
       color = "Number of childbirths")


```

```{r, include=F}

sd_kids_total <- sd(data_ashs$kids_total[data_ashs$sex==2], na.rm=TRUE)
prop_A <- prop.table(table(data_ashs$A[data_ashs$sex==2]))
p_A <- 0.336 
sd_A <- sqrt(p_A * (1 - p_A))

(134.143 * (sd_kids_total * sd_A) / sd(data_ashs$vol_HIPP[data_ashs$sex==2], na.rm=TRUE))^2

power.t.regression(beta = -134.143,
                   sd.predictor = sd_kids_total * sd_A,
                   sd.outcome = sd(data_ashs$vol_HIPP[data_ashs$sex==2], na.rm=TRUE),
                   r.squared = (134.143 * (sd_kids_total * sd_A) / sd(data_ashs$vol_HIPP[data_ashs$sex==2], na.rm=TRUE))^2,
                   null.beta = 0, 
                   k.total = 8, 
                   n=196, 
                   alpha=0.05)

```

Power analysis of our main linear regression yielded a value of 0.37. Therefore, we chose not to include stratified analysis by Aβ status, due to the high possibility of a type II error.

```{r, include=F}
mod_ashs_simple_men<-lmer(vol_HIPP ~  kids_total*diff_mri+A +age_v1 +APOE_binary + scale(vol_tiv) + education  +(1|subject), data = data_ashs[data_ashs$sex==1,])
summary(mod_ashs_simple_men)

mod_ashs_men<-lmer(vol_HIPP ~  kids_total*diff_mri*A +age_v1 +APOE_binary + scale(vol_tiv) + education  +(1|subject), data = data_ashs[data_ashs$sex==1,])
summary(mod_ashs_men)
plot_model(mod_ashs_men, type="int")

```

No main effect of parity was found in men but interestingly,the interaction of parity and Aβ significantly impacted whole hippocampal volume (β = `r tidy(mod_ashs_men)$estimate[10]`, p = `r tidy(mod_ashs_men)$p.value[10]`), but this time in an opposite pattern (Figure X).

```{r, echo=F, warning=F}

mod_ashs_men_plot<- lme4::lmer(vol_HIPP ~  kids_total*diff_mri*A +age_v1 +APOE_binary + scale(vol_tiv) + education  +(1|subject), data = data_ashs[data_ashs$sex==1,])
preds_hip_int_men <- ggpredict(mod_ashs_men_plot, terms = c("diff_mri", "kids_total", "A"))

preds_hip_int_men_A0<-as.data.frame(preds_hip_int_men)%>%
  rename(kids_total_factor = group,
         A=facet)%>%
  filter(A==0)%>%
  mutate(A = ifelse(A==0, "Aβ-", "Aβ-"),
         kids_total_factor = ifelse(kids_total_factor ==4, "4+", as.character(kids_total_factor)))%>%
  filter(kids_total_factor!= 5)


preds_hip_int_men_A1<-as.data.frame(preds_hip_int_men)%>%
  rename(kids_total_factor = group,
         A=facet)%>%
  filter(A==1)%>%
  mutate(A = ifelse(A==1, "Aβ+", "Aβ+"),
         kids_total_factor = ifelse(kids_total_factor == 4, "4+", as.character(kids_total_factor)))%>%
  filter(kids_total_factor!= 5)


data_ashs %>%
  filter(sex == 1, !is.na(A)) %>%
  mutate(kids_total_factor = ifelse(kids_total == 4, "4+", as.character(kids_total)),
         A = factor(A, levels = c("0", "1"), labels = c("Aβ-", "Aβ+")))%>%
  ggplot(aes(x = diff_mri, y = vol_HIPP, color = kids_total_factor)) +
  geom_point(alpha = 0.6, size=2) +
  geom_line(data =preds_hip_int_men_A0, aes(x=x, 
                                y=predicted, 
                                group=kids_total_factor), size=1.3) +
  geom_line(data =preds_hip_int_men_A1, aes(x=x, 
                                y=predicted, 
                                group=kids_total_factor), size=1.3) +
  geom_ribbon(data =preds_hip_int_men_A0, aes(x=x,  
                                  ymin= conf.low, 
                                  ymax = conf.high, 
                                  group=kids_total_factor), inherit.aes = F, alpha=.07)+
  geom_ribbon(data =preds_hip_int_men_A1, aes(x=x,  
                                  ymin= conf.low, 
                                  ymax = conf.high, 
                                  group=kids_total_factor), inherit.aes = F, alpha=.07)+
  facet_wrap(~A) +
  scale_color_manual(values = c("0" = "#8AD9B5", "1" = "#50B88E", "2" = "#047A56", "3" = "#0A5940", "4+" = "#0F3F2D")) +
  th +
  labs(x = "Time difference (years)", 
       y = "Whole hippocampus", 
       color = "Number of childbirths")


```

```{r, include=F}

mod_whole_intA0<-lmer(vol_HIPP ~  kids_total*diff_mri +age_v1 +APOE_binary + scale(vol_tiv) + education  +(1|subject), data = data_ashs[data_ashs$sex==2 & data_ashs$A==0,])
summary(mod_whole_intA0)


mod_whole_intA1<-lmer(vol_HIPP ~  kids_total*diff_mri +age_v1 +APOE_binary + scale(vol_tiv) + education  +(1|subject), data = data_ashs[data_ashs$sex==2 & data_ashs$A==1,])
summary(mod_whole_intA1)

#use pwrss package to estimate wether effect can be significant after stratification of groups

mod_whole_intA0_men<-lmer(vol_HIPP ~  kids_total*diff_mri +age_v1 +APOE_binary + scale(vol_tiv) + education  +(1|subject), data = data_ashs[data_ashs$sex==1 & data_ashs$A==0,])
summary(mod_whole_intA0_men)


mod_whole_intA1_men<-lmer(vol_HIPP ~  kids_total*diff_mri +age_v1 +APOE_binary + scale(vol_tiv) + education  +(1|subject), data = data_ashs[data_ashs$sex==1 & data_ashs$A==1,])
summary(mod_whole_intA1_men)

#almost definitely out of power for these strats
```

## Cognitive trajectory

```{r, include=F}
cognition<-read_excel("G:/My Drive/Data/ALFA+/Cognition/PACCv1_to_v3(incomplete).xlsx")%>%
  dplyr::select(IdParticipante, Visit, Z_PACC, Z_FCSRTI_RT, Z_aWMS_DR_RS, Z_Wclave_totalscr, Z_FS_totalcnswr, FechaResultado)%>%
  rename(subject = IdParticipante)%>%
  mutate(subject = as.numeric(subject))

time_diff<-read_excel("G:/My Drive/Data/ALFA+/Cognition/PACCv1_to_v3(incomplete).xlsx")%>%
  dplyr::select(IdParticipante, Visit,FechaResultado)%>%
  rename(subject = IdParticipante)%>%
  mutate(subject = as.numeric(subject))%>%
  filter(Visit != 3)%>%
  pivot_wider(names_from = Visit, values_from = FechaResultado, names_prefix = c("Fecha_Resultado"))%>%
  mutate(time_diff = as.numeric(difftime(Fecha_Resultado2, Fecha_Resultado1, units= c("days"))))%>%
  dplyr::select(subject, time_diff)

data_cog_long<- left_join(data, cognition)%>%
  mutate(age_cog = as.numeric(difftime(FechaResultado, DOB, units= c("days")))/365.25)%>%
  group_by(subject)%>%
  filter(Visit != 3) %>%
  filter(n()>=2)%>%
  relocate(Visit, .after=sex)%>%
  ungroup()%>%
  left_join(., time_diff)%>%
  mutate(time_diff = ifelse(Visit == 1, 0, time_diff))

fit_cog_simple_PACC<-lmer(Z_PACC ~ kids_total*time_diff +age_v1 + APOE_binary + education + A +(1 | subject), data_cog_long[data_cog_long$sex==2,])
summary(fit_cog_simple_PACC)

fit_cog_PACC<-lmer(Z_PACC ~ kids_total*A*time_diff +age_v1 + APOE_binary + education +(1 | subject), data_cog_long[data_cog_long$sex==2,])
summary(fit_cog_PACC)


```

No significan main effect of parity on PACC score was found. However, after moderation by Aβ status, a modest yet significant effect was found (β = `r tidy(fit_cog_PACC)$estimate[11]`, p=`r tidy(fit_cog_PACC)$p.value[11]`). Results suggest that whilst parity and Aβ status did not seem to affect PACC score at time = 0, Aβ- women appeared to show a positive relationship between parity and PACC score as time went on, and Aβ+ women the opposite.

```{r, echo=F, warning=F}

preds_PACC <- ggpredict(fit_cog_PACC, terms = c("time_diff", "kids_total", "A"))

preds_PACC_A0<-as.data.frame(preds_PACC)%>%
  rename(kids_total_factor = group,
         A=facet)%>%
  filter(A==0)%>%
  mutate(A = ifelse(A==0, "Aβ-", "Aβ-"),
         kids_total_factor = ifelse(kids_total_factor== 4, "4+", as.character(kids_total_factor)))


preds_PACC_A1<-as.data.frame(preds_PACC)%>%
  rename(kids_total_factor = group,
         A=facet)%>%
  filter(A==1)%>%
  mutate(A = ifelse(A==1, "Aβ+", "Aβ+"),
         kids_total_factor = ifelse(kids_total_factor== 4, "4+", as.character(kids_total_factor)))

#by time diff with predicted values - preferred?
data_cog_long %>%
  filter(sex == 2, !is.na(A)) %>%
  mutate(kids_total_factor = ifelse(kids_total == 4, "4+", as.character(kids_total)),
         A = factor(A, levels = c("0", "1"), labels = c("Aβ-", "Aβ+"))) %>%
  ggplot(aes(x = time_diff, y = Z_PACC, color = kids_total_factor)) +
  geom_point(alpha = 0.3, size=2) +
  geom_line(data =preds_PACC_A0, aes(x=x, 
                                y=predicted, 
                                group=kids_total_factor), size=1.3) +
  geom_line(data =preds_PACC_A1, aes(x=x, 
                                y=predicted, 
                                group=kids_total_factor), size=1.3) +
  geom_ribbon(data =preds_PACC_A0, aes(x=x,  
                                  ymin= conf.low, 
                                  ymax = conf.high, 
                                  group=kids_total_factor), inherit.aes = F, alpha=.07)+
  geom_ribbon(data =preds_PACC_A1, aes(x=x,  
                                  ymin= conf.low, 
                                  ymax = conf.high, 
                                  group=kids_total_factor), inherit.aes = F, alpha=.07)+
  facet_wrap(~A) +
  scale_color_manual(values = c("0" = "#A8D8EA", "1" = "#79A3D1", "2" = "#4A6FA5", "3" = "#2E4057", "4+" = "#1B263B")) +
  th +
  labs(x = "Time difference (days)", 
       y = "PACC Z-score", 
       color = "Number of childbirths")
```

## Post-hoc analyses

### Hippocampal subfields

```{r, include = F}

mod_ashs_DG<-lmer(vol_DG ~  kids_total*A*diff_mri +age_v1 +APOE_binary + scale(vol_tiv) + education +(1|subject), data = data_ashs[data_ashs$sex==2,])
summary(mod_ashs_DG)

plot_model(mod_ashs_DG, type= "int")

mod_ashs_SUB<-lmer(vol_SUB ~  kids_total*A*diff_mri +age_v1 +APOE_binary + scale(vol_tiv) + education +(1|subject), data = data_ashs[data_ashs$sex==2,])
summary(mod_ashs_SUB)

plot_model(mod_ashs_SUB, type= "int")

```

Similarly, no significant main effect of parity was found in any of the subfields. However, the interaction between Aβ status and parity showed a significant effect on dentate gyrus volume (β = `r tidy(mod_ashs_DG)$estimate[9]`, p = `r tidy(mod_ashs_DG)$p.value[9]`), and a trend in the subiculum (β = `r tidy(mod_ashs_SUB)$estimate[9]`, p = `r tidy(mod_ashs_SUB)$p.value[9]`). The direction of the effect followed the same as for the whole hippocampus, where Aβ- women showed a positive relationship between parity and hippocampal volume, whilst Aβ- women showed the opposite (Figure X)

```{r, echo=F, warning=F}
data_forest_plot<-data_ashs%>%
  filter(sex == 2 )

models<-list(
  CA1 = lmer(vol_CA1 ~ kids_total*A*diff_mri + scale(vol_tiv) + age_v1 + APOE_binary + education + (1 | subject),data = data_forest_plot),
  CA2 = lmer(vol_CA2 ~ kids_total*A*diff_mri + scale(vol_tiv) + age_v1 + APOE_binary + education +(1 | subject),data = data_forest_plot),
  CA3 = lmer(vol_CA3 ~ kids_total*A*diff_mri + scale(vol_tiv) + age_v1 + APOE_binary + education +(1 | subject),data = data_forest_plot),
  `Dentate gyrus` = lmer(vol_DG ~ kids_total*A*diff_mri + scale(vol_tiv) + age_v1 + APOE_binary + education +(1 | subject),data = data_forest_plot),
  `Entorhinal cortex` = lmer(vol_ERC ~ kids_total*A*diff_mri + scale(vol_tiv) + age_v1 + APOE_binary + education +(1 | subject),data = data_forest_plot),
  `Parahippocampal cortex` = lmer(vol_PHC ~ kids_total*A*diff_mri + scale(vol_tiv) + age_v1 + APOE_binary + education +(1 | subject),data = data_forest_plot),
  Subiculum = lmer(vol_SUB ~ kids_total*A*diff_mri + scale(vol_tiv) + age_v1 + APOE_binary + education +(1 | subject),data = data_forest_plot),
Sulcus = lmer(vol_sulcus ~ kids_total*A*diff_mri + scale(vol_tiv) + age_v1 + APOE_binary + education +(1 | subject),data = data_forest_plot)
)

# Extract coefficients and CIs
#install.packages("broom.mixed")

pred_hippo_all <- map_dfr(models, ~ {
  broom.mixed::tidy(.x, terms = c("kids_total", "A1"))   # Add consistent term column
}, .id = "region")%>%
  filter(term %in% c("kids_total", "A1", "kids_total:A1"))%>%
  dplyr::select(region, term, estimate, std.error)%>%
  pivot_wider(names_from = term, values_from = c(estimate, std.error))%>%
  mutate(plot_estimate_kids_A0 = estimate_kids_total,
         plot_estimate_kids_A1 = estimate_kids_total + `estimate_kids_total:A1`,
         plot_conf.low_kids_A0 = estimate_kids_total - 1.96 * std.error_kids_total,
         plot_conf.high_kids_A0 = estimate_kids_total + 1.96 * std.error_kids_total,
         plot_conf.low_kids_A1 = (estimate_kids_total + `estimate_kids_total:A1` - 1.96 * `std.error_kids_total:A1`),
         plot_conf.high_kids_A1 = (estimate_kids_total + `estimate_kids_total:A1` + 1.96 * `std.error_kids_total:A1`))%>%
  dplyr::select(-estimate_kids_total, -estimate_A1,-`estimate_kids_total:A1` ,-`std.error_kids_total`, -std.error_A1 ,         -`std.error_kids_total:A1`)%>%
  pivot_longer(
    cols = starts_with("plot_"),  # Keep 'term' as-is
    names_to = c(".value", "A"),  # .value creates columns like estimate, conf.low, etc.
    names_pattern = "plot_(.*)_kids_A(\\d+)"
  )%>%
  mutate(colour_group = case_when(region == "Subiculum" ~ "trend",
                                  region == "Dentate gyrus" ~ "significant",
                                  .default = "normal"))

pred_hippo_all %>%
  mutate(A = factor(A, levels = c("1", "0"), labels = c("Positive", "Negative"))) %>%
  ggplot(aes(x = estimate, y = region, group = A, shape = A, color = colour_group)) +
  geom_pointrange(aes(xmin = conf.low, xmax = conf.high), 
                  position = position_dodge(width = 0.8),
                  size = 0.6) +
  labs(x = "Estimated effect of parity", 
       y = "Hippocampal subfield", 
       shape = "Aβ status",
       color = "Significance level (FDR corrected)") +
  th +
  geom_vline(xintercept = 0, linetype = "dotted", colour = "grey3") +
  scale_shape_manual(values = c("Negative" = 15, "Positive" = 16))+
  scale_color_manual(values = c("trend" = "grey3", "significant" = "red", "normal" = "grey48"))+
  guides(colour = "none")
  
```

```{r, include=F}


mod_ashs_CA1_men<-lmer(vol_CA1 ~  kids_total*diff_mri*A +age_v1 +APOE_binary + scale(vol_tiv) + education +(1|subject), data = data_ashs[data_ashs$sex==1,])
summary(mod_ashs)

mod_ashs<-lmer(vol_CA2 ~ kids_total*diff_mri*A + age_v1 +APOE_binary + scale(vol_tiv) + education +(1|subject), data = data_ashs[data_ashs$sex==1,])
summary(mod_ashs)

mod_ashs<-lmer(vol_CA3 ~  kids_total*diff_mri*A +age_v1 +APOE_binary + scale(vol_tiv) + education +(1|subject), data = data_ashs[data_ashs$sex==1,])
summary(mod_ashs)

mod_ashs_DG_men<-lmer(vol_DG ~  kids_total*diff_mri*A +age_v1 +APOE_binary + scale(vol_tiv) + education +(1|subject), data = data_ashs[data_ashs$sex==1,])
summary(mod_ashs)

mod_ashs_sub_men<-lmer(vol_SUB ~  kids_total*diff_mri*A +age_v1 +APOE_binary + scale(vol_tiv) + education +(1|subject), data = data_ashs[data_ashs$sex==1,])
summary(mod_ashs)

mod_ashs<-lmer(vol_ERC ~  kids_total*diff_mri*A +age_v1 +APOE_binary + scale(vol_tiv) + education +(1|subject), data = data_ashs[data_ashs$sex==1,])
summary(mod_ashs)

mod_ashs_phc_men<-lmer(vol_PHC ~  kids_total*diff_mri*A +age_v1 +APOE_binary + scale(vol_tiv) + education +(1|subject), data = data_ashs[data_ashs$sex==1,])
summary(mod_ashs)

mod_ashs<-lmer(vol_BA35 ~  kids_total*diff_mri*A +age_v1 +APOE_binary + scale(vol_tiv) + education +(1|subject), data = data_ashs[data_ashs$sex==1,])
summary(mod_ashs)

mod_ashs<-lmer(vol_BA36 ~  kids_total*diff_mri*A +age_v1 +APOE_binary + scale(vol_tiv) + education +(1|subject), data = data_ashs[data_ashs$sex==1,])
summary(mod_ashs)


```

In men, exploratory analyses of the subfields showed a significant effect of the interaction between Aβ and parity in the CA1 (β = `r tidy(mod_ashs_CA1_men)$estimate[10]`, p= `r tidy(mod_ashs_CA1_men)$p.value[10]`) and the parahippocampal cortex (β = `r tidy(mod_ashs_phc_men)$estimate[10]`, p= `r tidy(mod_ashs_phc_men)$p.value[10]`), and a trending effect in the dentate gyrus (β = `r tidy(mod_ashs_DG_men)$estimate[10]`, p= `r tidy(mod_ashs_DG_men)$p.value[10]`) and the subiculum (β = `r tidy(mod_ashs_sub_men)$estimate[10]`, p= `r tidy(mod_ashs_sub_men)$p.value[10]`). Similarly to the effects found in the whole hippocampus, the direction of the interaction is reversed in men, such that Aβ+ men show a positive relationship between parity and subfield volume, and Aβ- men show the opposite (Figure X).

```{r, echo=F, warning=F}
data_forest_plot_men<-data_ashs%>%
  filter(sex == 1 )

models_men<-list(
  CA1 = lmer(vol_CA1 ~ kids_total*A*diff_mri + scale(vol_tiv) + age_v1 + APOE_binary + education + (1 | subject),data = data_forest_plot_men),
  CA2 = lmer(vol_CA2 ~ kids_total*A*diff_mri + scale(vol_tiv) + age_v1 + APOE_binary + education +(1 | subject),data = data_forest_plot_men),
  CA3 = lmer(vol_CA3 ~ kids_total*A*diff_mri + scale(vol_tiv) + age_v1 + APOE_binary + education +(1 | subject),data = data_forest_plot_men),
  `Dentate gyrus` = lmer(vol_DG ~ kids_total*A*diff_mri + scale(vol_tiv) + age_v1 + APOE_binary + education +(1 | subject),data = data_forest_plot_men),
  `Entorhinal cortex` = lmer(vol_ERC ~ kids_total*A*diff_mri + scale(vol_tiv) + age_v1 + APOE_binary + education +(1 | subject),data = data_forest_plot_men),
  `Parahippocampal cortex` = lmer(vol_PHC ~ kids_total*A*diff_mri + scale(vol_tiv) + age_v1 + APOE_binary + education +(1 | subject),data = data_forest_plot_men),
  Subiculum = lmer(vol_SUB ~ kids_total*A*diff_mri + scale(vol_tiv) + age_v1 + APOE_binary + education +(1 | subject),data = data_forest_plot_men),
Sulcus = lmer(vol_sulcus ~ kids_total*A*diff_mri + scale(vol_tiv) + age_v1 + APOE_binary + education +(1 | subject),data = data_forest_plot_men)
)

# Extract coefficients and CIs
#install.packages("broom.mixed")

pred_hippo_all_men <- map_dfr(models_men, ~ {
  broom.mixed::tidy(.x, terms = c("kids_total", "A1"))   # Add consistent term column
}, .id = "region")%>%
  filter(term %in% c("kids_total", "A1", "kids_total:A1"))%>%
  dplyr::select(region, term, estimate, std.error)%>%
  pivot_wider(names_from = term, values_from = c(estimate, std.error))%>%
  mutate(plot_estimate_kids_A0 = estimate_kids_total,
         plot_estimate_kids_A1 = estimate_kids_total + `estimate_kids_total:A1`,
         plot_conf.low_kids_A0 = estimate_kids_total - 1.96 * std.error_kids_total,
         plot_conf.high_kids_A0 = estimate_kids_total + 1.96 * std.error_kids_total,
         plot_conf.low_kids_A1 = (estimate_kids_total + `estimate_kids_total:A1` - 1.96 * `std.error_kids_total:A1`),
         plot_conf.high_kids_A1 = (estimate_kids_total + `estimate_kids_total:A1` + 1.96 * `std.error_kids_total:A1`))%>%
  dplyr::select(-estimate_kids_total, -estimate_A1,-`estimate_kids_total:A1` ,-`std.error_kids_total`, -std.error_A1 ,         -`std.error_kids_total:A1`)%>%
  pivot_longer(
    cols = starts_with("plot_"),  # Keep 'term' as-is
    names_to = c(".value", "A"),  # .value creates columns like estimate, conf.low, etc.
    names_pattern = "plot_(.*)_kids_A(\\d+)"
  )%>%
  mutate(colour_group = case_when(region == "Dentate gyrus" ~ "trend",
                                  region == "Subiculum" ~ "trend",
                                  region == "CA1" ~ "significant",
                                  region == "Parahippocampal cortex" ~ "significant",
                                  .default = "normal"))


pred_hippo_all_men %>%
  mutate(A = factor(A, levels = c("1", "0"), labels = c("Positive", "Negative"))) %>%
  ggplot(aes(x = estimate, y = region, group = A, shape = A, color = colour_group)) +
  geom_pointrange(aes(xmin = conf.low, xmax = conf.high), 
                  position = position_dodge(width = 0.8),
                  size = 0.6) +
  labs(x = "Estimated effect of parity", 
       y = "Hippocampal subfield", 
       shape = "Aβ status",
       color = "Significance level (FDR corrected)") +
  th +
  geom_vline(xintercept = 0, linetype = "dotted", colour = "grey3") +
  scale_shape_manual(values = c("Negative" = 15, "Positive" = 16))+
  scale_color_manual(values = c("trend" = "grey3", "significant" = "red", "normal" = "grey48"))+
  guides(colour = "none")
  
```

# Discussion

We aimed to investigate the impact of parity on hippocampal subfield volumes and relation to AD pathology in post-menopausal women at risk of AD and men who share similar age and AD risk. Our results suggest that...

Parity interacts with amyloid pathology to influence neurodegeneration and cognition. In our sample, parity was not associated with hippocampal volume size directly but appeared to moderate the effet of amyloid accumulation on hippocampal volume. In the context of low amyloid, female participants appeared to exhibit greater volumes especially in the subiculum and dentate gyrus area.

Interestingly, introducing variables that serve as proxy for hormonal exposure, such as HRT use and reproductive span, seemed to explain some of this effet in the dentate gyrus area but not in the subiculum.

Similarly, parity does not impact PACC score independently but appears to moderate the impact of amyloid pathology on cognitive trajectory. In the context of low amyloid, female participants with higher parity showed lesser cognitive decline. However, this effect was very small, especially compared with the effect of other variables, like education. Whilst including covariates related to sex steroid exposure did not modify this relationship, including household income did.

mention liisa galea's recent findings and how we don't find an interaction with APOE?

The biggest limitation of this study is the lack of hormonal measurements. By only using proxy measurements, we are only able to estimate the role of sex steroid hormones in the results found, but cannot make any definitive conclusions. It is very possible the role of sex hormones in our observatioins was underestimated due to this missing variable. In addition to this, the ALFA+ cohort is very homogeneous: participants are majoritarily caucasian whites, from middle and upper-middle class background, who were selected due to their impeccable health records. Therefore, we must use cuation when generalising our results to a wider population. Additionally, our sample lacked highly multiparous individuals. Previous studies on the effect of parity on cognition and neurodegeneration have found an inverted u-shaped relation between parity and outcome measures, indicating that our lack of women having had more than 4 children might be leading to an incomplete picture of the phenomenon.

# Appendix

## Analysis reproduction with ASHS
